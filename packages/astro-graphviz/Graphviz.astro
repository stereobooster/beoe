---
import { graphvizSvg } from "@datt/rehype-graphviz";
import { getCache } from "@datt/cache";

const cache = await getCache();

interface Props {
  code: string;
}

let svg: string;
svg = cache.get(Astro.props.code);
if (svg === undefined) {
  svg = graphvizSvg(Astro.props.code);
  cache.set(Astro.props.code, svg);
}
---

<div class="graphviz">
  <Fragment set:html={svg} />
</div>
