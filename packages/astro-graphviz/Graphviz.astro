---
// I can't use internal modules - don't know why
// import { processGraphvizSvg } from "@beoe/rehype-graphviz";
// import { getCache } from "@beoe/cache";
import { Graphviz } from "@hpcc-js/wasm";
const graphviz = await Graphviz.load();

// const cache = await getCache();

interface Props {
  code: string;
  class?: string;
}

let svg: string;
// const cacheKey = Astro.props.code;
// svg = cache.get(cacheKey);
// if (svg === undefined) {
svg = graphviz.dot(Astro.props.code);
//   cache.set(cacheKey, svg);
// }
---

<figure class={`beoe graphviz ${Astro.props.class || ""}`}>
  <Fragment set:html={svg} />
</figure>
